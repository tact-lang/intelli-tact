<!--suppress PluginXmlValidity -->
<idea-plugin>
    <id>org.tonstudio.tact</id>
    <name>Tact</name>
    <vendor>TON Studio</vendor>

    <category>Languages</category>
    <description><![CDATA[
Provides official support for <a href="https://tact-lang.org/">Tact</a> programming language
    ]]></description>

    <depends>com.intellij.modules.platform</depends>

    <resource-bundle>messages.TactBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Tact Language -->
        <fileType name="Tact"
                  implementationClass="org.tonstudio.tact.lang.TactFileType"
                  fieldName="INSTANCE"
                  language="tact"
                  extensions="tact"/>

        <!-- region Language general -->
        <lang.parserDefinition language="tact" implementationClass="org.tonstudio.tact.lang.TactParserDefinition"/>
        <lang.syntaxHighlighter language="tact" implementationClass="org.tonstudio.tact.lang.TactSyntaxHighlighter"/>
        <lang.commenter language="tact" implementationClass="org.tonstudio.tact.lang.TactCommenter"/>
        <lang.braceMatcher language="tact" implementationClass="org.tonstudio.tact.lang.TactBraceMatcher"/>
        <lang.quoteHandler language="tact" implementationClass="org.tonstudio.tact.lang.TactQuoteHandler"/>
        <lang.foldingBuilder language="tact" implementationClass="org.tonstudio.tact.lang.folding.TactFoldingBuilder"/>
        <lang.findUsagesProvider language="tact" implementationClass="org.tonstudio.tact.lang.usages.TactFindUsagesProvider"/>
        <readWriteAccessDetector implementation="org.tonstudio.tact.lang.usages.TactReadWriteAccessDetector"/>
        <elementDescriptionProvider implementation="org.tonstudio.tact.lang.usages.TactDescriptionProvider"/>
        <spellchecker.support language="tact" implementationClass="org.tonstudio.tact.lang.TactSpellcheckingStrategy"/>
        <lang.elementManipulator forClass="org.tonstudio.tact.lang.psi.TactStringLiteral"
                                 implementationClass="org.tonstudio.tact.lang.psi.impl.manipulator.TactStringLiteralManipulator"/>
        <lang.psiStructureViewFactory language="tact" implementationClass="org.tonstudio.tact.lang.structure.TactStructureViewFactory"/>
        <!-- endregion Language general -->

        <!-- region Completion -->
        <completion.contributor
                language="tact"
                implementationClass="org.tonstudio.tact.lang.completion.contributors.TactKeywordsCompletionContributor"/>
        <completion.contributor
                language="tact"
                implementationClass="org.tonstudio.tact.lang.completion.contributors.TactCompletionContributor"/>
        <enterHandlerDelegate implementation="org.tonstudio.tact.lang.completion.TripleSlashEnterHandler"/>
        <!-- endregion Completion -->

        <!-- region Indexes -->
        <stubIndex implementation="org.tonstudio.tact.lang.stubs.index.TactMethodIndex"/>
        <stubIndex implementation="org.tonstudio.tact.lang.stubs.index.TactNamesIndex"/>
        <stubIndex implementation="org.tonstudio.tact.lang.stubs.index.TactContractsTraitsIndex"/>
        <stubIndex implementation="org.tonstudio.tact.lang.stubs.index.TactStructIndex"/>
        <stubIndex implementation="org.tonstudio.tact.lang.stubs.index.TactClassLikeIndex"/>
        <stubElementTypeHolder class="org.tonstudio.tact.lang.TactTypes" externalIdPrefix="tact."/>
        <!-- endregion Indexes -->

        <!-- region Annotator -->
        <annotator language="tact" order="first" implementationClass="org.tonstudio.tact.lang.annotator.TactDumbAwareAnnotator"/>
        <annotator language="tact" implementationClass="org.tonstudio.tact.lang.annotator.TactAnnotator"/>
        <!-- endregion Annotator -->

        <!-- region CodeVision & Hints -->
        <!-- Hints -->
        <codeInsight.declarativeInlayProvider language="tact"
                                              bundle="messages.TactBundle"
                                              nameKey="tact.inlay.hints.variables"
                                              group="VALUES_GROUP"
                                              implementationClass="org.tonstudio.tact.ide.hints.TactVariableTypeHintsProvider"
                                              isEnabledByDefault="true"
                                              providerId="tact.inlay.hints.variables"/>

       <codeInsight.declarativeInlayProvider language="tact"
                                              bundle="messages.TactBundle"
                                              nameKey="tact.inlay.hints.get.methods"
                                              group="VALUES_GROUP"
                                              implementationClass="org.tonstudio.tact.ide.hints.TactGetMethodIdHintsProvider"
                                              isEnabledByDefault="true"
                                              providerId="tact.inlay.hints.get.methods"/>

       <codeInsight.declarativeInlayProvider language="tact"
                                              bundle="messages.TactBundle"
                                              nameKey="tact.inlay.hints.assembly.info"
                                              group="VALUES_GROUP"
                                              implementationClass="org.tonstudio.tact.ide.hints.TactAssemblyInfoHintsProvider"
                                              isEnabledByDefault="true"
                                              providerId="tact.inlay.hints.assembly.info"/>

       <codeInsight.declarativeInlayProvider language="tact"
                                              bundle="messages.TactBundle"
                                              nameKey="tact.inlay.hints.gas.consumption"
                                              group="VALUES_GROUP"
                                              implementationClass="org.tonstudio.tact.ide.hints.TactGasConsumptionHintsProvider"
                                              isEnabledByDefault="true"
                                              providerId="tact.inlay.hints.gas.consumption"/>

       <codeInsight.declarativeInlayProvider language="tact"
                                              bundle="messages.TactBundle"
                                              nameKey="tact.inlay.hints.require.exit.code.info"
                                              group="VALUES_GROUP"
                                              implementationClass="org.tonstudio.tact.ide.hints.TacRequireExitCodeHintsProvider"
                                              isEnabledByDefault="true"
                                              providerId="tact.inlay.hints.require.exit.code.info"/>

        <codeInsight.parameterNameHints language="tact" id="TactParameterNameHintsProvider"
                                        implementationClass="org.tonstudio.tact.ide.hints.TactParameterNameHintsProvider"/>

        <!-- Code vision -->
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.tonstudio.tact.ide.hints.TactUsagesCodeVisionProvider"/>
        <vcs.codeVisionLanguageContext language="tact" implementationClass="org.tonstudio.tact.ide.hints.TactCodeVisionLanguageContext"/>
        <codeInsight.codeVisionSettingsPreviewLanguage modelId="vcs.code.vision" language="tact"/>
        <codeInsight.codeVisionSettingsPreviewLanguage modelId="references" language="tact"/>
        <!-- endregion CodeVision & Hints -->

        <!-- region Imports -->
        <lang.importOptimizer language="tact" implementationClass="org.tonstudio.tact.lang.imports.TactImportOptimizer"/>
        <referenceImporter implementation="org.tonstudio.tact.lang.imports.TactReferenceImporter"/>
        <!-- endregion Imports -->

        <!-- region Searches -->
        <definitionsScopedSearch implementation="org.tonstudio.tact.lang.search.TactSuperMethodSearch"/>
        <definitionsScopedSearch implementation="org.tonstudio.tact.lang.search.TactImplementationsSearch"/>
        <definitionsScopedSearch implementation="org.tonstudio.tact.lang.search.TactFunctionImplementationsSearch"/>
        <codeInsight.lineMarkerProvider language="tact"
                                        implementationClass="org.tonstudio.tact.lang.search.TactSuperMarkerProvider"/>
        <codeInsight.lineMarkerProvider language="tact"
                                        implementationClass="org.tonstudio.tact.lang.search.TactImplementationsProvider"/>
        <codeInsight.gotoSuper language="tact"
                               implementationClass="org.tonstudio.tact.lang.search.TactGotoSuperHandler"/>
        <!--  endregion Searches -->

        <!-- region Code Insight -->
        <codeInsight.typeInfo language="tact" implementationClass="org.tonstudio.tact.ide.codeInsight.TactTypeInfoProvider"/>
        <codeInsight.parameterInfo language="tact"
                                   implementationClass="org.tonstudio.tact.ide.codeInsight.TactParameterInfoHandler"/>
        <codeInsight.lineMarkerProvider language="tact"
                                        implementationClass="org.tonstudio.tact.ide.highlight.TactRecursiveCallMarkerProvider"/>
        <!-- endregion Code Insight -->

        <!-- region Documentation -->
        <lang.documentationProvider language="tact"
                                    implementationClass="org.tonstudio.tact.ide.documentation.TactDocumentationProvider"/>
        <!-- endregion Documentation -->

        <!-- region Injection -->
        <multiHostInjector implementation="org.tonstudio.tact.ide.injections.TactDoctestLanguageInjector"/>
        <!-- endregion Injection -->

        <!-- region Formatter -->
        <!-- TODO: lang.formatter -->
        <!-- TODO: langCodeStyleSettingsProvider -->
        <formattingService implementation="org.tonstudio.tact.lang.formatter.TactFormattingService"/>
        <!-- endregion Formatter -->

        <!-- region Navigation -->
        <gotoClassContributor implementation="org.tonstudio.tact.ide.navigation.TactGotoClassLikeContributor"/>
        <gotoSymbolContributor implementation="org.tonstudio.tact.ide.navigation.TactGotoSymbolContributor"/>
        <!-- endregion Navigation -->

        <!-- region Color Settings & Schemes -->
        <colorSettingsPage implementation="org.tonstudio.tact.ide.colors.TactColorsSettingsPage"/>

        <additionalTextAttributes scheme="Default" file="colorSchemes/TactAddonsDefault.xml"/>
        <additionalTextAttributes scheme="Darcula" file="colorSchemes/TactAddonsDarcula.xml"/>
        <additionalTextAttributes scheme="New Dark" file="colorSchemes/TactAddonsNewDark.xml"/>
        <!-- endregion Color Schemes -->

        <!-- region Editor -->
        <postStartupActivity implementation="org.tonstudio.tact.ide.TactPostStartupActivity"/>
        <lang.formatter language="tact"
            implementationClass="org.tonstudio.tact.lang.formatter.TactFormattingModelBuilder"/>
        <breadcrumbsInfoProvider implementation="org.tonstudio.tact.ide.editor.TactBreadcrumbsInfoProvider"/>
        <!-- endregion Editor -->

        <!-- region Toolchains -->
        <editorNotificationProvider implementation="org.tonstudio.tact.project.TactMissingToolchainNotificationProvider"/>
        <applicationService serviceImplementation="org.tonstudio.tact.toolchain.TactKnownToolchainsState"/>
        <!-- endregion Toolchains -->

        <!-- region Project -->
        <additionalLibraryRootsProvider implementation="org.tonstudio.tact.project.TactAdditionalLibraryRootsProvider"/>
        <projectConfigurable groupId="language" instance="org.tonstudio.tact.configurations.TactProjectSettingsConfigurable"
                             id="MainTactSettings"
                             dynamic="true" displayName="Tact"/>
        <projectConfigurable parentId="MainTactSettings"
                             instance="org.tonstudio.tact.configurations.TactFmtSettingsConfigurable"
                             id="org.tonstudio.tact.configurations.TactFmtSettingsConfigurable"
                             dynamic="true" displayName="Tactfmt"/>
        <fileDocumentManagerListener implementation="org.tonstudio.tact.project.TactFmtWatcher$TactFmtListener"/>
        <!-- endregion Project -->

        <!-- region General inspections -->
        <localInspection language="tact" groupPath="Tact"
                         groupName="General" shortName="TactUnresolvedReferenceInspection"
                         displayName="Unresolved reference"
                         enabledByDefault="true" level="INFO"
                         implementationClass="org.tonstudio.tact.ide.inspections.TactUnresolvedReferenceInspection"/>

        <localInspection language="tact" groupPath="Tact"
                         groupName="Unused" shortName="TactUnusedImportInspection"
                         displayName="Unused import inspection"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.tonstudio.tact.ide.inspections.unused.TactUnusedImportInspection"/>
        <localInspection language="tact" groupPath="Tact"
                         groupName="Unused" shortName="TactAmbiguousImportInspection"
                         displayName="Ambiguous import"
                         enabledByDefault="true" level="ERROR"
                         implementationClass="org.tonstudio.tact.ide.inspections.TactAmbiguousImportInspection"/>
        <!-- endregion General inspections -->

    </extensions>

    <actions>
        <action id="tact.new.file" class="org.tonstudio.tact.ide.actions.CreateTactFileAction">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFile"/>
        </action>
    </actions>

    <extensions defaultExtensionNs="org.tonstudio.tact">
        <!-- Toolchain flavors -->
        <toolchainFlavor id="tact.localToolchainFlavor"
                         implementation="org.tonstudio.tact.projectWizard.flavors.TactLocalToolchainFlavor"/>
       <toolchainFlavor id="tact.compilerRepositoryToolchainFlavor"
                         implementation="org.tonstudio.tact.projectWizard.flavors.TactCompilerRepositoryToolchainFlavor"/>
        <!-- Toolchain flavors End -->
    </extensions>

    <extensionPoints>
        <extensionPoint interface="org.tonstudio.tact.projectWizard.TactToolchainFlavor"
                        dynamic="true" name="toolchainFlavor"/>
    </extensionPoints>

</idea-plugin>
